% Press "Run" to load the data in to the MATLAB workspace. To get started,
% try typing "plot(freqHz, mag)" in the command window (after running this
% file). 
% Type "help semilogx" and "help plot" or go to the Mathworks documentation 
% page on "plot" to learn more. Pay special attention to "hold."
% Other useful things: help grid, help subplot, help rad2deg.
freq_hz = [...
   100.000, 	   116.600, 	   135.900, ...
   158.500, 	   184.800, 	   215.400, ...
   251.200, 	   292.900, 	   341.500, ...
   398.100, 	   464.200, 	   541.200, ...
   631.000, 	   735.600, 	   857.700, ...
  1000.000, 	  1166.000, 	  1359.000, ...
  1585.000, 	  1848.000, 	  2154.000, ...
  2512.000, 	  2929.000, 	  3415.000, ...
  3981.000, 	  4642.000, 	  5412.000, ...
  6310.000, 	  7356.000, 	  8577.000, ...
 10000.000, 	 11660.000, 	 13590.000, ...
 15850.000, 	 18480.000, 	 21540.000, ...
 25120.000, 	 29290.000, 	 34150.000, ...
 39810.000, 	 46420.000, 	 54120.000, ...
 63100.000, 	 73560.000, 	 85770.000, ...
100000.000];

mag_dB = [...
   -50.508, 	   -49.099, 	   -47.714, ...
   -46.232, 	   -44.701, 	   -43.176, ...
   -41.541, 	   -39.830, 	   -38.018, ...
   -36.109, 	   -34.054, 	   -31.968, ...
   -29.700, 	   -27.350, 	   -24.898, ...
   -22.320, 	   -19.652, 	   -16.850, ...
   -13.888, 	   -10.785, 	    -7.271, ...
    -3.337, 	     1.068, 	     5.653, ...
     7.822, 	     6.670, 	     4.964, ...
     3.589, 	     2.576, 	     1.841, ...
     1.305, 	     0.919, 	     0.638, ...
     0.432, 	     0.284, 	     0.175, ...
     0.094, 	     0.033, 	    -0.011, ...
    -0.045, 	    -0.071, 	    -0.093, ...
    -0.111, 	    -0.126, 	    -0.139, ...
    -0.152];

mag_v = [...
     0.003, 	     0.004, 	     0.004, ...
     0.005, 	     0.006, 	     0.007, ...
     0.008, 	     0.010, 	     0.013, ...
     0.016, 	     0.020, 	     0.025, ...
     0.033, 	     0.043, 	     0.057, ...
     0.077, 	     0.104, 	     0.144, ...
     0.202, 	     0.289, 	     0.433, ...
     0.681, 	     1.131, 	     1.917, ...
     2.461, 	     2.155, 	     1.771, ...
     1.512, 	     1.345, 	     1.236, ...
     1.162, 	     1.112, 	     1.076, ...
     1.051, 	     1.033, 	     1.020, ...
     1.011, 	     1.004, 	     0.999, ...
     0.995, 	     0.992, 	     0.989, ...
     0.987, 	     0.986, 	     0.984, ...
     0.983];

mag_vout = [...
     0.001, 	     0.002, 	     0.002, ...
     0.002, 	     0.003, 	     0.003, ...
     0.004, 	     0.005, 	     0.006, ...
     0.008, 	     0.010, 	     0.013, ...
     0.016, 	     0.021, 	     0.029, ...
     0.038, 	     0.052, 	     0.072, ...
     0.101, 	     0.143, 	     0.212, ...
     0.326, 	     0.515, 	     0.771, ...
     0.925, 	     0.879, 	     0.780, ...
     0.696, 	     0.636, 	     0.593, ...
     0.562, 	     0.541, 	     0.526, ...
     0.515, 	     0.506, 	     0.499, ...
     0.492, 	     0.490, 	     0.493, ...
     0.492, 	     0.491, 	     0.490, ...
     0.489, 	     0.489, 	     0.489, ...
     0.488];

mag_vin = [...
     0.484, 	     0.485, 	     0.486, ...
     0.487, 	     0.488, 	     0.489, ...
     0.491, 	     0.493, 	     0.494, ...
     0.496, 	     0.497, 	     0.499, ...
     0.500, 	     0.500, 	     0.501, ...
     0.501, 	     0.501, 	     0.500, ...
     0.499, 	     0.496, 	     0.490, ...
     0.479, 	     0.456, 	     0.402, ...
     0.376, 	     0.408, 	     0.441, ...
     0.461, 	     0.473, 	     0.479, ...
     0.484, 	     0.486, 	     0.489, ...
     0.490, 	     0.490, 	     0.489, ...
     0.486, 	     0.488, 	     0.494, ...
     0.494, 	     0.495, 	     0.495, ...
     0.496, 	     0.496, 	     0.497, ...
     0.497];

phase_rad = [...
     1.742, 	     1.778, 	     1.816, ...
     1.861, 	     1.906, 	     1.962, ...
     2.023, 	     2.089, 	     2.156, ...
     2.226, 	     2.294, 	     2.364, ...
     2.428, 	     2.488, 	     2.539, ...
     2.583, 	     2.616, 	     2.637, ...
     2.645, 	     2.634, 	     2.594, ...
     2.504, 	     2.310, 	     1.889, ...
     1.224, 	     0.715, 	     0.449, ...
     0.306, 	     0.222, 	     0.168, ...
     0.131, 	     0.105, 	     0.086, ...
     0.070, 	     0.058, 	     0.049, ...
     0.040, 	     0.034, 	     0.028, ...
     0.023, 	     0.019, 	     0.015, ...
     0.012, 	     0.009, 	     0.007, ...
     0.005];



omega = 2 * pi *freq_hz;

transfer = (j .* omega).^2 ./ ((j .* omega).^2 + 6666.67 * j .* omega + 666666666.7);

calc_phase = angle(transfer);
calc_mag = 20 * log10(abs(transfer));
semilogx(freq_hz,phase_rad);
hold on
semilogx(freq_hz,calc_phase);

xlabel("Frequency, Hz");
ylabel("Phase, rad");
