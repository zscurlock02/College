% Press "Run" to load the data in to the MATLAB workspace. To get started,
% try typing "plot(freqHz, mag)" in the command window (after running this
% file). 
% Type "help semilogx" and "help plot" or go to the Mathworks documentation 
% page on "plot" to learn more. Pay special attention to "hold."
% Other useful things: help grid, help subplot, help rad2deg.
freq_hz = [...
   100.000, 	   116.600, 	   135.900, ...
   158.500, 	   184.800, 	   215.400, ...
   251.200, 	   292.900, 	   341.500, ...
   398.100, 	   464.200, 	   541.200, ...
   631.000, 	   735.600, 	   857.700, ...
  1000.000, 	  1166.000, 	  1359.000, ...
  1585.000, 	  1848.000, 	  2154.000, ...
  2512.000, 	  2929.000, 	  3415.000, ...
  3981.000, 	  4642.000, 	  5412.000, ...
  6310.000, 	  7356.000, 	  8577.000, ...
 10000.000, 	 11660.000, 	 13590.000, ...
 15850.000, 	 18480.000, 	 21540.000, ...
 25120.000, 	 29290.000, 	 34150.000, ...
 39810.000, 	 46420.000, 	 54120.000, ...
 63100.000, 	 73560.000, 	 85770.000, ...
100000.000];

mag_dB = [...
    -0.240, 	    -0.239, 	    -0.237, ...
    -0.234, 	    -0.228, 	    -0.221, ...
    -0.212, 	    -0.199, 	    -0.183, ...
    -0.160, 	    -0.130, 	    -0.090, ...
    -0.035, 	     0.039, 	     0.139, ...
     0.278, 	     0.471, 	     0.742, ...
     1.127, 	     1.681, 	     2.480, ...
     3.667, 	     5.294, 	     7.187, ...
     6.794, 	     3.225, 	    -0.835, ...
    -4.692, 	    -8.109, 	   -11.339, ...
   -14.453, 	   -17.522, 	   -20.296, ...
   -23.244, 	   -26.052, 	   -28.802, ...
   -31.587, 	   -34.336, 	   -37.083, ...
   -39.824, 	   -42.642, 	   -45.384, ...
   -48.178, 	   -50.926, 	   -53.908, ...
   -56.648];

mag_v = [...
     0.973, 	     0.973, 	     0.973, ...
     0.973, 	     0.974, 	     0.975, ...
     0.976, 	     0.977, 	     0.979, ...
     0.982, 	     0.985, 	     0.990, ...
     0.996, 	     1.005, 	     1.016, ...
     1.033, 	     1.056, 	     1.089, ...
     1.139, 	     1.214, 	     1.330, ...
     1.525, 	     1.839, 	     2.287, ...
     2.186, 	     1.450, 	     0.908, ...
     0.583, 	     0.393, 	     0.271, ...
     0.189, 	     0.133, 	     0.097, ...
     0.069, 	     0.050, 	     0.036, ...
     0.026, 	     0.019, 	     0.014, ...
     0.010, 	     0.007, 	     0.005, ...
     0.004, 	     0.003, 	     0.002, ...
     0.001];

mag_vout = [...
     0.456, 	     0.457, 	     0.457, ...
     0.459, 	     0.460, 	     0.462, ...
     0.464, 	     0.466, 	     0.469, ...
     0.471, 	     0.474, 	     0.478, ...
     0.481, 	     0.486, 	     0.492, ...
     0.499, 	     0.510, 	     0.524, ...
     0.545, 	     0.575, 	     0.621, ...
     0.691, 	     0.792, 	     0.891, ...
     0.842, 	     0.628, 	     0.427, ...
     0.284, 	     0.196, 	     0.136, ...
     0.096, 	     0.067, 	     0.049, ...
     0.035, 	     0.025, 	     0.018, ...
     0.013, 	     0.010, 	     0.007, ...
     0.005, 	     0.004, 	     0.003, ...
     0.002, 	     0.001, 	     0.001, ...
     0.001];

mag_vin = [...
     0.469, 	     0.469, 	     0.470, ...
     0.471, 	     0.472, 	     0.474, ...
     0.475, 	     0.477, 	     0.479, ...
     0.480, 	     0.481, 	     0.483, ...
     0.483, 	     0.484, 	     0.484, ...
     0.483, 	     0.483, 	     0.481, ...
     0.478, 	     0.474, 	     0.466, ...
     0.453, 	     0.431, 	     0.390, ...
     0.385, 	     0.433, 	     0.470, ...
     0.488, 	     0.498, 	     0.502, ...
     0.505, 	     0.506, 	     0.507, ...
     0.508, 	     0.507, 	     0.506, ...
     0.503, 	     0.504, 	     0.510, ...
     0.511, 	     0.511, 	     0.511, ...
     0.512, 	     0.512, 	     0.513, ...
     0.513];

phase_rad = [...
    -0.010, 	    -0.011, 	    -0.013, ...
    -0.015, 	    -0.018, 	    -0.020, ...
    -0.024, 	    -0.028, 	    -0.033, ...
    -0.038, 	    -0.045, 	    -0.053, ...
    -0.063, 	    -0.074, 	    -0.087, ...
    -0.104, 	    -0.124, 	    -0.150, ...
    -0.183, 	    -0.230, 	    -0.299, ...
    -0.411, 	    -0.620, 	    -1.052, ...
    -1.740, 	    -2.271, 	    -2.555, ...
    -2.715, 	    -2.814, 	    -2.880, ...
    -2.927, 	    -2.962, 	    -2.989, ...
    -3.010, 	    -3.027, 	    -3.041, ...
    -3.052, 	    -3.062, 	    -3.069, ...
    -3.075, 	    -3.083, 	    -3.087, ...
    -3.089, 	    -3.084, 	    -3.092, ...
    -3.096];


omega = 2 * pi *freq_hz;

%calc_mag = 20 * log10( 20.66 .* 10^8 ./ (sqrt((10^8 - omega.^2).^2 + (20000 .* omega).^2)));
transfer = 666666666.7 ./ ((j .* omega).^2 + 6666.67 * j .* omega + 666666666.7);

calc_phase = angle(transfer);
calc_mag = 20 * log10(abs(transfer));
semilogx(freq_hz,phase_rad);
hold on
semilogx(freq_hz,calc_phase);

xlabel("Frequency, Hz");
ylabel("Phase, rad");

