% Press "Run" to load the data in to the MATLAB workspace. To get started,
% try typing "plot(freqHz, mag)" in the command window (after running this
% file). 
% Type "help semilogx" and "help plot" or go to the Mathworks documentation 
% page on "plot" to learn more. Pay special attention to "hold."
% Other useful things: help grid, help subplot, help rad2deg.
freq_hz = [...
   100.000, 	   116.600, 	   135.900, ...
   158.500, 	   184.800, 	   215.400, ...
   251.200, 	   292.900, 	   341.500, ...
   398.100, 	   464.200, 	   541.200, ...
   631.000, 	   735.600, 	   857.700, ...
  1000.000, 	  1166.000, 	  1359.000, ...
  1585.000, 	  1848.000, 	  2154.000, ...
  2512.000, 	  2929.000, 	  3415.000, ...
  3981.000, 	  4642.000, 	  5412.000, ...
  6310.000, 	  7356.000, 	  8577.000, ...
 10000.000, 	 11660.000, 	 13590.000, ...
 15850.000, 	 18480.000, 	 21540.000, ...
 25120.000, 	 29290.000, 	 34150.000, ...
 39810.000, 	 46420.000, 	 54120.000, ...
 63100.000, 	 73560.000, 	 85770.000, ...
100000.000];

mag_dB = [...
     0.012, 	     0.015, 	     0.017, ...
     0.021, 	     0.025, 	     0.030, ...
     0.034, 	     0.036, 	     0.032, ...
     0.013, 	    -0.046, 	    -0.176, ...
    -0.437, 	    -0.934, 	    -1.771, ...
    -3.040, 	    -4.744, 	    -6.784, ...
    -9.108, 	   -11.546, 	   -14.158, ...
   -16.657, 	   -19.385, 	   -21.984, ...
   -24.625, 	   -27.259, 	   -29.971, ...
   -32.553, 	   -35.178, 	   -37.962, ...
   -40.514, 	   -43.170, 	   -45.978, ...
   -48.657, 	   -51.324, 	   -53.891, ...
   -56.377, 	   -58.712, 	   -60.753, ...
   -62.337, 	   -63.272, 	   -63.503, ...
   -62.684, 	   -61.222, 	   -59.355, ...
   -57.058];

mag_v = [...
     1.001, 	     1.002, 	     1.002, ...
     1.002, 	     1.003, 	     1.003, ...
     1.004, 	     1.004, 	     1.004, ...
     1.001, 	     0.995, 	     0.980, ...
     0.951, 	     0.898, 	     0.816, ...
     0.705, 	     0.579, 	     0.458, ...
     0.350, 	     0.265, 	     0.196, ...
     0.147, 	     0.107, 	     0.080, ...
     0.059, 	     0.043, 	     0.032, ...
     0.024, 	     0.017, 	     0.013, ...
     0.009, 	     0.007, 	     0.005, ...
     0.004, 	     0.003, 	     0.002, ...
     0.002, 	     0.001, 	     0.001, ...
     0.001, 	     0.001, 	     0.001, ...
     0.001, 	     0.001, 	     0.001, ...
     0.001];

mag_vout = [...
     5.005, 	     5.023, 	     5.041, ...
     5.061, 	     5.080, 	     5.097, ...
     5.112, 	     5.118, 	     5.115, ...
     5.097, 	     5.051, 	     4.960, ...
     4.792, 	     4.507, 	     4.074, ...
     3.506, 	     2.872, 	     2.265, ...
     1.730, 	     1.305, 	     0.966, ...
     0.724, 	     0.529, 	     0.392, ...
     0.289, 	     0.214, 	     0.156, ...
     0.116, 	     0.086, 	     0.062, ...
     0.046, 	     0.034, 	     0.025, ...
     0.018, 	     0.013, 	     0.010, ...
     0.007, 	     0.006, 	     0.005, ...
     0.004, 	     0.003, 	     0.003, ...
     0.004, 	     0.004, 	     0.005, ...
     0.007];

mag_vin = [...
     4.998, 	     5.015, 	     5.031, ...
     5.049, 	     5.065, 	     5.080, ...
     5.092, 	     5.096, 	     5.097, ...
     5.090, 	     5.077, 	     5.061, ...
     5.040, 	     5.019, 	     4.996, ...
     4.975, 	     4.958, 	     4.945, ...
     4.938, 	     4.932, 	     4.929, ...
     4.927, 	     4.925, 	     4.923, ...
     4.926, 	     4.925, 	     4.923, ...
     4.921, 	     4.924, 	     4.922, ...
     4.924, 	     4.920, 	     4.920, ...
     4.917, 	     4.908, 	     4.890, ...
     4.864, 	     4.867, 	     4.918, ...
     4.917, 	     4.915, 	     4.913, ...
     4.908, 	     4.902, 	     4.893, ...
     4.885];

phase_rad = [...
    -0.141, 	    -0.165, 	    -0.193, ...
    -0.227, 	    -0.266, 	    -0.311, ...
    -0.365, 	    -0.430, 	    -0.508, ...
    -0.601, 	    -0.715, 	    -0.853, ...
    -1.019, 	    -1.214, 	    -1.432, ...
    -1.659, 	    -1.877, 	    -2.073, ...
    -2.242, 	    -2.383, 	    -2.500, ...
    -2.597, 	    -2.677, 	    -2.744, ...
    -2.800, 	    -2.847, 	    -2.887, ...
    -2.921, 	    -2.949, 	    -2.974, ...
    -2.994, 	    -3.013, 	    -3.029, ...
    -3.045, 	    -3.060, 	    -3.075, ...
    -3.094, 	    -3.118, 	    -3.150, ...
    -3.185, 	    -3.226, 	    -3.242, ...
    -3.270, 	    -3.268, 	    -3.244, ...
    -3.221];

omega = 2 * pi *freq_hz;

transfer = (6283.19^2) ./ ((j .* omega).^2 + (6283.19/2) * j .* omega + 6283.19^2);

calc_phase = angle(transfer);
calc_mag = 20 * log10(abs(transfer));
semilogx(freq_hz,phase_rad);
hold on
semilogx(freq_hz,calc_phase);

xlabel("Frequency, Hz");
ylabel("Phase, rad");
