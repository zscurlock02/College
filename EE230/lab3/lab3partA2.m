% Press "Run" to load the data in to the MATLAB workspace. To get started,
% try typing "plot(freqHz, mag)" in the command window (after running this
% file). 
% Type "help semilogx" and "help plot" or go to the Mathworks documentation 
% page on "plot" to learn more. Pay special attention to "hold."
% Other useful things: help grid, help subplot, help rad2deg.
freq_hz = [...
   100.000, 	   146.800, 	   215.400, ...
   316.200, 	   464.200, 	   681.300, ...
  1000.000, 	  1468.000, 	  2154.000, ...
  3162.000, 	  4642.000, 	  6813.000, ...
 10000.000, 	 14680.000, 	 21540.000, ...
 31620.000, 	 46420.000, 	 68130.000, ...
100000.000];

mag_dB = [...
    26.041, 	    25.991, 	    25.894, ...
    25.699, 	    25.307, 	    24.535, ...
    23.101, 	    20.677, 	    17.119, ...
    12.415, 	     6.925, 	     0.970, ...
    -5.297, 	   -11.845, 	   -18.438, ...
   -25.121, 	   -31.853, 	   -38.559, ...
   -45.458];

mag_v = [...
    20.048, 	    19.931, 	    19.710, ...
    19.272, 	    18.422, 	    16.856, ...
    14.291, 	    10.811, 	     7.177, ...
     4.176, 	     2.219, 	     1.118, ...
     0.543, 	     0.256, 	     0.120, ...
     0.055, 	     0.026, 	     0.012, ...
     0.005];

mag_vout = [...
     2.401, 	     2.398, 	     2.388, ...
     2.356, 	     2.271, 	     2.090, ...
     1.777, 	     1.346, 	     0.894, ...
     0.520, 	     0.277, 	     0.139, ...
     0.068, 	     0.032, 	     0.015, ...
     0.007, 	     0.003, 	     0.001, ...
     0.001];

mag_vin = [...
     0.120, 	     0.120, 	     0.121, ...
     0.122, 	     0.123, 	     0.124, ...
     0.124, 	     0.125, 	     0.125, ...
     0.125, 	     0.125, 	     0.125, ...
     0.125, 	     0.125, 	     0.124, ...
     0.125, 	     0.125, 	     0.125, ...
     0.126];

phase_rad = [...
    -0.129, 	    -0.189, 	    -0.275, ...
    -0.399, 	    -0.575, 	    -0.816, ...
    -1.124, 	    -1.482, 	    -1.849, ...
    -2.181, 	    -2.452, 	    -2.657, ...
    -2.806, 	    -2.914, 	    -2.992, ...
    -3.051, 	    -3.099, 	    -3.141, ...
    -3.171];

omega = 2 * pi *freq_hz;

calc_mag = 20 * log10( 20.66 .* 10^8 ./ (sqrt((10^8 - omega.^2).^2 + (20000 .* omega).^2)));
transfer = 20.66 * (10^8 ./ ((j * omega) .^ 2 + 20000 * j .* omega + 10^8));
%calc_phase = -atan((20000) * (omega ./ (10^8 - omega .^ 2)));
calc_phase = angle(transfer);
semilogx(freq_hz,mag_dB);
hold on
semilogx(freq_hz,phase_rad);

xlabel("Frequency, Hz");
ylabel("Phase, rad");



